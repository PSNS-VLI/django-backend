"use strict";(self["webpackChunkERP_Experiment"]=self["webpackChunkERP_Experiment"]||[]).push([[361],{6251:function(t,e,a){a.d(e,{Z:function(){return D}});a(26699),a(32023);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"wrapper"},[t.operation?e("div",{staticClass:"table-operation"},[e("a-row",{attrs:{gutter:48}},[t.operation.includes("edit")?e("a-col",{attrs:{md:3,sm:6}},[e("a-button",{attrs:{type:t.isEdit?"default":"primary",icon:"edit"},on:{click:function(e){t.isEdit=!t.isEdit}}},[t.isEdit?[t._v("取消编辑")]:[t._v("编辑")]],2)],1):t._e(),t.operation.includes("add")?e("a-col",{attrs:{md:3,sm:6}},[e("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.handleAdd}},[t._v(" 新增 ")])],1):t._e(),t.operation.includes("delete")?e("a-col",{attrs:{md:3,sm:6}},[e("a-button",{attrs:{type:t.isDelete?"default":"primary",icon:"delete"},on:{click:function(e){t.isDelete=!t.isDelete}}},[t.isDelete?[t._v("取消删除")]:[t._v("删除")]],2)],1):t._e(),t.operation.includes("search")?e("a-col",{attrs:{md:6,sm:6}},[e("a-input-search",{attrs:{placeholder:"Search"}})],1):t._e()],1)],1):t._e(),e("div",{staticClass:"table-wrapper"},[t.hasSide?e("a-table",{attrs:{bordered:"",columns:t.sideColumns,locale:t.locale}},[t.title?e("template",{slot:"title"},[e("div",{staticClass:"table-title"},[t._v(t._s(t.title))])]):t._e()],2):t._e(),e("a-table",{attrs:{bordered:"",columns:t.mainColAndScoped.columns,"data-source":t.mainData,pagination:!1},scopedSlots:t._u([t._l(t.mainColAndScoped.dataIndexList,(function(a){return{key:a,fn:function(n,i,r){return["operation"!==a?e("div",{key:a},[t.mainColAndScoped.textFields.includes(a)?e("div",[e("keep-alive",[t.isEdit&&!t.frozenList.includes(a)?e("a-input",{staticStyle:{margin:"-5px 0"},attrs:{value:n},on:{input:function(e){return t.handleChange(e.target.value,i,r,a)}}}):e("div",[t._v(" "+t._s(n)+" ")])],1)],1):e("div",[e("keep-alive",[t.isEdit&&!t.frozenList.includes(a)?e("a-input-number",{staticStyle:{margin:"-5px 0"},attrs:{value:n},on:{change:function(e){return t.handleChange(e,i,r,a)}}}):e("div",[t._v(" "+t._s(n)+" ")])],1)],1)]):t._e(),"operation"===a&&t.isDelete?e("div",{key:a},[e("a-popconfirm",{attrs:{title:"确认删除?"},on:{confirm:function(){return t.handleDelete(i)}}},[e("a",{attrs:{href:"javascript:;"}},[t._v("Delete")])])],1):t._e()]}}}))],null,!0)},[!t.hasSide&&t.title?e("template",{slot:"title"},[e("div",{staticClass:"table-title"},[t._v(t._s(t.title))])]):t._e()],2)],1)])},i=[],r=a(3360),l=(a(41539),a(54747),a(34553),a(40561),a(92222),a(39714),a(21249),a(69826),a(83465)),s=a.n(l),o=function(){var t=this,e=t._self._c;return e("div")},u=[],c={data:function(){return{}}},d=c,p=a(1001),m=(0,p.Z)(d,o,u,!1,null,null,null),f=m.exports,h={model:{prop:"mainData",event:"change"},props:{title:{type:String,default:""},hasSide:{type:Boolean,default:!0},operation:{type:String,default:""},sideColumns:{type:Array,default:function(){return[]}},frozenList:{type:Array,default:function(){return[]}},mainColumns:{type:Array,default:function(){return[]}},mainData:{type:Array,default:function(){return[]}}},data:function(){var t=this.$createElement;return this.locale={emptyText:t(f)},{isEdit:!1,isDelete:!1}},computed:{mainColAndScoped:function(){var t=s()(this.mainColumns),e=[],a=[];function n(t){t.forEach((function(t){t.dataIndex?(t.scopedSlots={customRender:t.dataIndex},e.push(t.dataIndex),t.type&&"text"===t.type&&a.push(t.dataIndex)):t.children&&n(t.children)}))}if(n(t),this.isDelete)t.push({title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}),e.push("operation");else{var i=t.findIndex((function(t){return"operation"===t.dataIndex})),r=t.findIndex((function(t){return"operation"===t.dataIndex}));t.splice(i>=0?i:t.length,1),e.splice(r>=0?r:e.length,1)}return{columns:t,dataIndexList:e,textFields:a}},inputListeners:function(){return Object.assign({},this.$linsteners,{blur:function(){this.$emit("change")}})}},methods:{handleAdd:function(){this.$emit("change",this.mainData.concat([Object.assign({key:Date.now().toString()},this.mainColAndScoped.dataIndexList.reduce((function(t,e){return t[e]=0,t}),{}))]))},handleDelete:function(t){var e=s()(this.mainData);e.splice(e.findIndex((function(e){return e.key===t.key})),1),this.$emit("change",e)},handleChange:function(t,e,a,n){var i=this.mainData.map((function(t){return(0,r.Z)({},t)}));i.find((function(t){return t.key===e.key}))[n]=t,this.$emit("change",i)}}},v=h,_=(0,p.Z)(v,n,i,!1,null,"8642ca34",null),D=_.exports},44361:function(t,e,a){a.r(e),a.d(e,{default:function(){return y}});a(68309);var n=function(){var t=this,e=t._self._c;return e("page-header-wrapper",[e("a-card",{attrs:{bordered:!1}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"}},[e("a-row",{attrs:{gutter:48}},[e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"选择项目"}},[e("a-select",{attrs:{placeholder:t.showRules[t.showParam.explosionRule].name,"default-value":t.showParam.defaultRule},on:{change:t.handleRuleChange},model:{value:t.showParam.explosionRule,callback:function(e){t.$set(t.showParam,"explosionRule",e)},expression:"showParam.explosionRule"}},[t._l(t.showRules,(function(a){return[e("a-select-option",{key:a.key,attrs:{value:a.value}},[t._v(t._s(a.name))])]}))],2)],1)],1)],1)],1)],1)]),e("a-card",{attrs:{bordered:!1}},[e("MRP",{attrs:{sideColumns:t.sideColumns,mainColumns:t.mainColumns,tableData:t.tableData}})],1)],1)},i=[],r=a(3360),l=a(50686),s=a(20629),o=function(){var t=this,e=t._self._c;return e("a-card",{attrs:{bordered:!1}},[e("div",{staticClass:"table-wrapper"},[e("ErpTable",{attrs:{title:"PA26-50 的MRP",operation:"edit",frozenList:t.frozenList,mainColumns:t.mainColumns,sideColumns:t.sideColumns},model:{value:t.mainData,callback:function(e){t.mainData=e},expression:"mainData"}})],1)])},u=[],c=(a(41539),a(47042),a(26833),a(6251)),d={components:{ErpTable:c.Z},props:{sideColumns:{type:Array,default:function(){return[]}},mainColumns:{type:Array,default:function(){return[]}},tableData:{type:Array,default:function(){return[]}}},data:function(){return this.frozenList=["name"],{mainData:[]}},watch:{tableData:{immediate:!0,handler:function(t){this.calMainData(t)}}},methods:{calMainData:function(t){this.mainData=this.inflateMainData(t,(0,l._1)(this.extractMainData(t),20,160,1))},extractMainData:function(t){return t.reduce((function(t,e){return t.push(Object.values(e).slice(3)),t}),[])},inflateMainData:function(t,e){return t.reduce((function(t,a,n){return t.push(Object.assign({},a,e[n].reduce((function(t,e,a){return t[0===a?"current_zone":"zone_".concat(a)]=e,t}),{}))),t}),[])}}},p=d,m=a(1001),f=(0,m.Z)(p,o,u,!1,null,"54757a08",null),h=f.exports,v={components:{MRP:h},data:function(){return this.sideColumns=[{title:"计划接收量"},{title:"80"},{title:"提前期"},{title:"1"},{title:"当期PAB"},{title:"安全库存"},{title:"20"},{title:"批量"},{title:"160"}],{showParam:{explosionRule:0,defaultRule:0},mainColumns:[],tableData:[]}},computed:(0,r.Z)({},(0,s.Se)("erp",{showRules:"mrpList",POReleDict:"POReleDict"})),created:function(){this.mainColumns=(0,l.wR)("mrp",[2,2,3]),this.tableData=this.genTableData([0,50,50,60,60,60,60,90])},methods:{handleRuleChange:function(t){this.tableData=this.genTableData(this.POReleDict[this.showRules[t].key]),this.$emit("showRuleChange")},genTableData:function(t){var e=(0,l.s)("mrp",[2,2,3],{field:{parent:"ZXC"}});if(!t)return e;var a=(0,l.tA)(e);return a[0]=t,a[3][0]=20,(0,l.Qm)(e,a)}}},_=v,D=(0,m.Z)(_,n,i,!1,null,null,null),y=D.exports}}]);